{
  "Name": "Laravel RCE (CVE-2021-3129)",
  "Description": "Ignition before 2.5.2, as used in Laravel and other products, allows unauthenticated remote attackers to execute arbitrary code because of insecure usage of file_get_contents() and file_put_contents(). This is exploitable on sites using debug mode with Laravel before 8.4.2.",
  "Product": "Laravel-Framework",
  "Homepage": "https://laravel.com/",
  "DisclosureDate": "2021-01-12",
  "Author": "desktop-n7qn2h0\\go0p\r\n",
  "FofaQuery": "app=\"Laravel-Framework\"",
  "GobyQuery": "app=\"Laravel-Framework\"",
  "Level": "3",
  "Impact": "",
  "Recommendation": "",
  "References": null,
  "RealReferences": [
    "https://github.com/facade/ignition/pull/334",
    "https://www.ambionics.io/blog/laravel-debug-rce",
    "https://nvd.nist.gov/vuln/detail/CVE-2021-3129",
    "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-3129"
  ],
  "HasExp": true,
  "ExpParams": [
    {
      "Name": "AttackType",
      "Type": "select",
      "Value": "webshell"
    },
	{
      "Name": "cmd",
      "Type": "input",
      "Value": "whoami"
    }
  ],
  "ExpTips": {
    "Type": "",
    "Content": ""
  },
  "ScanSteps": [
    "AND",
    {
      "Request": {
        "data": "",
        "data_type": "text",
        "follow_redirect": true,
        "method": "GET",
        "uri": "/_ignition/execute-solution"
      },
      "ResponseTest": {
        "checks": [
          {
            "bz": "",
            "operation": "==",
            "type": "item",
            "value": "405",
            "variable": "$code"
          },
		  {
            "bz": "",
            "operation": "contains",
            "type": "item",
            "value": "laravel",
            "variable": "$body"
          }
        ],
        "operation": "AND",
        "type": "group"
      }
    }
  ],
  "ExploitSteps": null,
  "Tags": ["rce", "getshell"],
  "CVEIDs": [
    "CVE-2021-3129"
  ],
  "CVSSScore": "9.8",
  "AttackSurfaces": {
    "Application": null,
    "Support": ["Laravel-Framework"],
    "Service": null,
    "System": null,
    "Hardware": null
  },
  "Disable": false
}